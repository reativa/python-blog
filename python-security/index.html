<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.1d07f1255d05a1395a48.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.18.12"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script>
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '2374911412821725'); // Insert your pixel ID here.
  fbq('track', 'PageView');
      </script><script>window.dataLayer = window.dataLayer || [];window.dataLayer.push({"platform":"plataforma-reativa"}); (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'GTM-KZH8KWD');</script><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/icons/icon-48x48.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a4533d42454f73956ac7c2f680393b78"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a4533d42454f73956ac7c2f680393b78"/><title data-react-helmet="true">Python tudo sobre segurança | Python para impacientes</title><meta data-react-helmet="true" name="description" content="Simple https server Generate a SSH key pair Get certificate information output: Generate a self-signed certificate output: Prepare a Certificate Signing Request…"/><meta data-react-helmet="true" property="og:title" content="Python tudo sobre segurança"/><meta data-react-helmet="true" property="og:description" content="Simple https server Generate a SSH key pair Get certificate information output: Generate a self-signed certificate output: Prepare a Certificate Signing Request…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Reativa"/><meta data-react-helmet="true" name="twitter:title" content="Python tudo sobre segurança"/><meta data-react-helmet="true" name="twitter:description" content="Simple https server Generate a SSH key pair Get certificate information output: Generate a self-signed certificate output: Prepare a Certificate Signing Request…"/><link as="script" rel="preload" href="/webpack-runtime-002569f02672c1c38772.js"/><link as="script" rel="preload" href="/styles-989bb08664f2608f37ec.js"/><link as="script" rel="preload" href="/netlify-identity-widget-71f3202b04975b5e224a.js"/><link as="script" rel="preload" href="/app-da4c9f678cc075cd8c26.js"/><link as="script" rel="preload" href="/commons-2011af21236d35f89581.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-2642abeb110b544c12ef.js"/><link as="fetch" rel="preload" href="/page-data/python-security/page-data.json" crossorigin="anonymous"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KZH8KWD" height="0" width="0" style="display: none; visibility: hidden"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Python para impacientes</a></h3></header><main><article><header><h1 style="margin-top:1.75rem;margin-bottom:0">Python tudo sobre segurança</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem">January 05, 2020</p></header><section><h1></h1>
<h2>Simple https server</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token comment"># python2</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> BaseHTTPServer<span class="token punctuation">,</span> SimpleHTTPServer
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> ssl
<span class="token operator">>></span><span class="token operator">></span> host<span class="token punctuation">,</span> port <span class="token operator">=</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token number">5566</span>
<span class="token operator">>></span><span class="token operator">></span> handler <span class="token operator">=</span> SimpleHTTPServer<span class="token punctuation">.</span>SimpleHTTPRequestHandler
<span class="token operator">>></span><span class="token operator">></span> httpd <span class="token operator">=</span> BaseHTTPServer<span class="token punctuation">.</span>HTTPServer<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> httpd<span class="token punctuation">.</span>socket <span class="token operator">=</span> ssl<span class="token punctuation">.</span>wrap_socket<span class="token punctuation">(</span>httpd<span class="token punctuation">.</span>socket<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                certfile<span class="token operator">=</span><span class="token string">'./cert.crt'</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                keyfile<span class="token operator">=</span><span class="token string">'./cert.key'</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                server_side<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> httpd<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># python3</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> http <span class="token keyword">import</span> server
<span class="token operator">>></span><span class="token operator">></span> handler <span class="token operator">=</span> server<span class="token punctuation">.</span>SimpleHTTPRequestHandler
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> ssl
<span class="token operator">>></span><span class="token operator">></span> host<span class="token punctuation">,</span> port <span class="token operator">=</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token number">5566</span>
<span class="token operator">>></span><span class="token operator">></span> httpd <span class="token operator">=</span> server<span class="token punctuation">.</span>HTTPServer<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> httpd<span class="token punctuation">.</span>socket <span class="token operator">=</span> ssl<span class="token punctuation">.</span>wrap_socket<span class="token punctuation">(</span>httpd<span class="token punctuation">.</span>socket<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                certfile<span class="token operator">=</span><span class="token string">'./cert.crt'</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                keyfile<span class="token operator">=</span><span class="token string">'./cert.key'</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                server_side<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">>></span><span class="token operator">></span> httpd<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Generate a SSH key pair</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> serialization
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> rsa
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend

key <span class="token operator">=</span> rsa<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span>
    backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    public_exponent<span class="token operator">=</span><span class="token number">65537</span><span class="token punctuation">,</span>
    key_size<span class="token operator">=</span><span class="token number">2048</span>
<span class="token punctuation">)</span>
private_key <span class="token operator">=</span> key<span class="token punctuation">.</span>private_bytes<span class="token punctuation">(</span>
    serialization<span class="token punctuation">.</span>Encoding<span class="token punctuation">.</span>PEM<span class="token punctuation">,</span>
    serialization<span class="token punctuation">.</span>PrivateFormat<span class="token punctuation">.</span>PKCS8<span class="token punctuation">,</span>
    serialization<span class="token punctuation">.</span>NoEncryption<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
public_key <span class="token operator">=</span> key<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>public_bytes<span class="token punctuation">(</span>
    serialization<span class="token punctuation">.</span>Encoding<span class="token punctuation">.</span>OpenSSH<span class="token punctuation">,</span>
    serialization<span class="token punctuation">.</span>PublicFormat<span class="token punctuation">.</span>OpenSSH
<span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'id_rsa'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'id_rsa.pub'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> g<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>private_key<span class="token punctuation">)</span>
    g<span class="token punctuation">.</span>write<span class="token punctuation">(</span>public_key<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Get certificate information</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> cryptography <span class="token keyword">import</span> x509
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend

backend <span class="token operator">=</span> default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./cert.crt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    crt_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cert <span class="token operator">=</span> x509<span class="token punctuation">.</span>load_pem_x509_certificate<span class="token punctuation">(</span>crt_data<span class="token punctuation">,</span> backend<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Certificate</span><span class="token punctuation">:</span>

    _fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'country_name'</span><span class="token punctuation">,</span>
               <span class="token string">'state_or_province_name'</span><span class="token punctuation">,</span>
               <span class="token string">'locality_name'</span><span class="token punctuation">,</span>
               <span class="token string">'organization_name'</span><span class="token punctuation">,</span>
               <span class="token string">'organizational_unit_name'</span><span class="token punctuation">,</span>
               <span class="token string">'common_name'</span><span class="token punctuation">,</span>
               <span class="token string">'email_address'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cert<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>cert<span class="token punctuation">,</span> x509<span class="token punctuation">.</span>Certificate<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_cert <span class="token operator">=</span> cert
        <span class="token keyword">for</span> attr <span class="token keyword">in</span> self<span class="token punctuation">.</span>_fields<span class="token punctuation">:</span>
            oid <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>x509<span class="token punctuation">,</span> <span class="token string">'OID_'</span> <span class="token operator">+</span> attr<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            subject <span class="token operator">=</span> cert<span class="token punctuation">.</span>subject
            info <span class="token operator">=</span> subject<span class="token punctuation">.</span>get_attributes_for_oid<span class="token punctuation">(</span>oid<span class="token punctuation">)</span>
            <span class="token builtin">setattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> attr<span class="token punctuation">,</span> info<span class="token punctuation">)</span>


cert <span class="token operator">=</span> Certificate<span class="token punctuation">(</span>cert<span class="token punctuation">)</span>
<span class="token keyword">for</span> attr <span class="token keyword">in</span> cert<span class="token punctuation">.</span>_fields<span class="token punctuation">:</span>
    <span class="token keyword">for</span> info <span class="token keyword">in</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>cert<span class="token punctuation">,</span> attr<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>_oid<span class="token punctuation">.</span>_name<span class="token punctuation">,</span> info<span class="token punctuation">.</span>_value<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ genrsa -out cert.key
Generating RSA private key, <span class="token number">1024</span> bit long modulus
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>++++++
<span class="token punctuation">..</span>.++++++
e is <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
$ openssl req -x509 -new -nodes <span class="token punctuation">\</span>
<span class="token operator">></span>       -key cert.key -days <span class="token number">365</span> <span class="token punctuation">\</span>
<span class="token operator">></span>       -out cert.crt
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span class="token string">'.'</span>, the field will be left blank.
-----
Country Name <span class="token punctuation">(</span><span class="token number">2</span> letter code<span class="token punctuation">)</span> <span class="token punctuation">[</span>AU<span class="token punctuation">]</span>:TW
State or Province Name <span class="token punctuation">(</span>full name<span class="token punctuation">)</span> <span class="token punctuation">[</span>Some-State<span class="token punctuation">]</span>:Taiwan
Locality Name <span class="token punctuation">(</span>eg, city<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>:Taipei
Organization Name <span class="token punctuation">(</span>eg, company<span class="token punctuation">)</span> <span class="token punctuation">[</span>Internet Widgits Pty Ltd<span class="token punctuation">]</span>:personal
Organizational Unit Name <span class="token punctuation">(</span>eg, section<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>:personal
Common Name <span class="token punctuation">(</span>e.g. server FQDN or YOUR name<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>:localhost
Email Address <span class="token punctuation">[</span><span class="token punctuation">]</span>:test@example.com
$ python3 cert.py
countryName: TW
stateOrProvinceName: Taiwan
localityName: Taipei
organizationName: personal
organizationalUnitName: personal
commonName: localhost
emailAddress: test@example.com</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Generate a self-signed certificate</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta
<span class="token keyword">from</span> OpenSSL <span class="token keyword">import</span> crypto

<span class="token comment"># load private key</span>
ftype <span class="token operator">=</span> crypto<span class="token punctuation">.</span>FILETYPE_PEM
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'key.pem'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> k <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
k <span class="token operator">=</span> crypto<span class="token punctuation">.</span>load_privatekey<span class="token punctuation">(</span>ftype<span class="token punctuation">,</span> k<span class="token punctuation">)</span>

now    <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
expire <span class="token operator">=</span> now <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">365</span><span class="token punctuation">)</span>

<span class="token comment"># country (countryName, C)</span>
<span class="token comment"># state or province name (stateOrProvinceName, ST)</span>
<span class="token comment"># locality (locality, L)</span>
<span class="token comment"># organization (organizationName, O)</span>
<span class="token comment"># organizational unit (organizationalUnitName, OU)</span>
<span class="token comment"># common name (commonName, CN)</span>

cert <span class="token operator">=</span> crypto<span class="token punctuation">.</span>X509<span class="token punctuation">(</span><span class="token punctuation">)</span>
cert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>C  <span class="token operator">=</span> <span class="token string">"TW"</span>
cert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ST <span class="token operator">=</span> <span class="token string">"Taiwan"</span>
cert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>L  <span class="token operator">=</span> <span class="token string">"Taipei"</span>
cert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>O  <span class="token operator">=</span> <span class="token string">"pysheeet"</span>
cert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>OU <span class="token operator">=</span> <span class="token string">"cheat sheet"</span>
cert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CN <span class="token operator">=</span> <span class="token string">"pythonsheets.com"</span>
cert<span class="token punctuation">.</span>set_serial_number<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
cert<span class="token punctuation">.</span>set_notBefore<span class="token punctuation">(</span>now<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d%H%M%SZ"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
cert<span class="token punctuation">.</span>set_notAfter<span class="token punctuation">(</span>expire<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d%H%M%SZ"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
cert<span class="token punctuation">.</span>set_issuer<span class="token punctuation">(</span>cert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
cert<span class="token punctuation">.</span>set_pubkey<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
cert<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token string">'sha1'</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cert.pem'</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>crypto<span class="token punctuation">.</span>dump_certificate<span class="token punctuation">(</span>ftype<span class="token punctuation">,</span> cert<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ openssl genrsa -out key.pem <span class="token number">2048</span>
Generating RSA private key, <span class="token number">2048</span> bit long modulus
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.+++
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>+++
e is <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
$ python3 x509.py
$ openssl x509 -subject -issuer -noout -in cert.pem
<span class="token assign-left variable">subject</span><span class="token operator">=</span> /C<span class="token operator">=</span>TW/ST<span class="token operator">=</span>Taiwan/L<span class="token operator">=</span>Taipei/O<span class="token operator">=</span>pysheeet/OU<span class="token operator">=</span>cheat sheet/CN<span class="token operator">=</span>pythonsheets.com
<span class="token assign-left variable">issuer</span><span class="token operator">=</span> /C<span class="token operator">=</span>TW/ST<span class="token operator">=</span>Taiwan/L<span class="token operator">=</span>Taipei/O<span class="token operator">=</span>pysheeet/OU<span class="token operator">=</span>cheat sheet/CN<span class="token operator">=</span>pythonsheets.com</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Prepare a Certificate Signing Request (csr)</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">from</span> OpenSSL <span class="token keyword">import</span> crypto

<span class="token comment"># load private key</span>
ftype <span class="token operator">=</span> crypto<span class="token punctuation">.</span>FILETYPE_PEM
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'key.pem'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> key <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> crypto<span class="token punctuation">.</span>load_privatekey<span class="token punctuation">(</span>ftype<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
req    <span class="token operator">=</span> crypto<span class="token punctuation">.</span>X509Req<span class="token punctuation">(</span><span class="token punctuation">)</span>

alt_name  <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">b"DNS:www.pythonsheeets.com"</span><span class="token punctuation">,</span>
              <span class="token string">b"DNS:doc.pythonsheeets.com"</span> <span class="token punctuation">]</span>
key_usage <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">b"Digital Signature"</span><span class="token punctuation">,</span>
              <span class="token string">b"Non Repudiation"</span><span class="token punctuation">,</span>
              <span class="token string">b"Key Encipherment"</span> <span class="token punctuation">]</span>

<span class="token comment"># country (countryName, C)</span>
<span class="token comment"># state or province name (stateOrProvinceName, ST)</span>
<span class="token comment"># locality (locality, L)</span>
<span class="token comment"># organization (organizationName, O)</span>
<span class="token comment"># organizational unit (organizationalUnitName, OU)</span>
<span class="token comment"># common name (commonName, CN)</span>

req<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>C  <span class="token operator">=</span> <span class="token string">"TW"</span>
req<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ST <span class="token operator">=</span> <span class="token string">"Taiwan"</span>
req<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>L  <span class="token operator">=</span> <span class="token string">"Taipei"</span>
req<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>O  <span class="token operator">=</span> <span class="token string">"pysheeet"</span>
req<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>OU <span class="token operator">=</span> <span class="token string">"cheat sheet"</span>
req<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CN <span class="token operator">=</span> <span class="token string">"pythonsheets.com"</span>
req<span class="token punctuation">.</span>add_extensions<span class="token punctuation">(</span><span class="token punctuation">[</span>
    crypto<span class="token punctuation">.</span>X509Extension<span class="token punctuation">(</span> <span class="token string">b"basicConstraints"</span><span class="token punctuation">,</span>
                          <span class="token boolean">False</span><span class="token punctuation">,</span>
                          <span class="token string">b"CA:FALSE"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    crypto<span class="token punctuation">.</span>X509Extension<span class="token punctuation">(</span> <span class="token string">b"keyUsage"</span><span class="token punctuation">,</span>
                          <span class="token boolean">False</span><span class="token punctuation">,</span>
                          <span class="token string">b","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>key_usage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    crypto<span class="token punctuation">.</span>X509Extension<span class="token punctuation">(</span> <span class="token string">b"subjectAltName"</span><span class="token punctuation">,</span>
                          <span class="token boolean">False</span><span class="token punctuation">,</span>
                          <span class="token string">b","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>alt_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

req<span class="token punctuation">.</span>set_pubkey<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
req<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">"sha256"</span><span class="token punctuation">)</span>

csr <span class="token operator">=</span> crypto<span class="token punctuation">.</span>dump_certificate_request<span class="token punctuation">(</span>ftype<span class="token punctuation">,</span> req<span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"cert.csr"</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>csr<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># create a root ca</span>
$ openssl genrsa -out ca-key.pem <span class="token number">2048</span>
Generating RSA private key, <span class="token number">2048</span> bit long modulus
<span class="token punctuation">..</span><span class="token punctuation">..</span>.+++
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.+++
e is <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
$ openssl req -x509 -new -nodes -key ca-key.pem <span class="token punctuation">\</span>
<span class="token operator">></span> -days <span class="token number">10000</span> -out ca.pem -subj <span class="token string">"/CN=root-ca"</span>

<span class="token comment"># prepare a csr</span>
$ openssl genrsa -out key.pem <span class="token number">2048</span>
Generating RSA private key, <span class="token number">2048</span> bit long modulus
<span class="token punctuation">..</span><span class="token punctuation">..</span>+++
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>+++
e is <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
$ python3 x509.py

<span class="token comment"># prepare openssl.cnf</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">></span> openssl.cnf
<span class="token operator">></span> <span class="token punctuation">[</span>req<span class="token punctuation">]</span>
<span class="token operator">></span> req_extensions <span class="token operator">=</span> v3_req
<span class="token operator">></span> distinguished_name <span class="token operator">=</span> req_distinguished_name
<span class="token operator">></span> <span class="token punctuation">[</span>req_distinguished_name<span class="token punctuation">]</span>
<span class="token operator">></span> <span class="token punctuation">[</span> v3_req <span class="token punctuation">]</span>
<span class="token operator">></span> basicConstraints <span class="token operator">=</span> CA:FALSE
<span class="token operator">></span> keyUsage <span class="token operator">=</span> nonRepudiation, digitalSignature, keyEncipherment
<span class="token operator">></span> subjectAltName <span class="token operator">=</span> @alt_names
<span class="token operator">></span> <span class="token punctuation">[</span>alt_names<span class="token punctuation">]</span>
<span class="token operator">></span> DNS.1 <span class="token operator">=</span> www.pythonsheets.com
<span class="token operator">></span> DNS.2 <span class="token operator">=</span> doc.pythonsheets.com
<span class="token operator">></span> EOF

<span class="token comment"># sign a csr</span>
$ openssl x509 -req -in cert.csr -CA ca.pem <span class="token punctuation">\</span>
<span class="token operator">></span> -CAkey ca-key.pem -CAcreateserial -out cert.pem <span class="token punctuation">\</span>
<span class="token operator">></span> -days <span class="token number">365</span> -extensions v3_req -extfile openssl.cnf
Signature ok
<span class="token assign-left variable">subject</span><span class="token operator">=</span>/C<span class="token operator">=</span>TW/ST<span class="token operator">=</span>Taiwan/L<span class="token operator">=</span>Taipei/O<span class="token operator">=</span>pysheeet/OU<span class="token operator">=</span>cheat sheet/CN<span class="token operator">=</span>pythonsheets.com
Getting CA Private Key

<span class="token comment"># check</span>
$ openssl x509 -in cert.pem -text -noout</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Generate RSA keyfile without passphrase</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token comment"># $ openssl genrsa cert.key 2048</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> serialization
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> rsa
<span class="token operator">>></span><span class="token operator">></span> key <span class="token operator">=</span> rsa<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> public_exponent<span class="token operator">=</span><span class="token number">65537</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> key_size<span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cert.key'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>key<span class="token punctuation">.</span>private_bytes<span class="token punctuation">(</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     encoding<span class="token operator">=</span>serialization<span class="token punctuation">.</span>Encoding<span class="token punctuation">.</span>PEM<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token builtin">format</span><span class="token operator">=</span>serialization<span class="token punctuation">.</span>PrivateFormat<span class="token punctuation">.</span>TraditionalOpenSSL<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     encryption_algorithm<span class="token operator">=</span>serialization<span class="token punctuation">.</span>NoEncryption<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Sign a file by a given private key</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Signature <span class="token keyword">import</span> PKCS1_v1_5
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Hash <span class="token keyword">import</span> SHA256


<span class="token keyword">def</span> <span class="token function">signer</span><span class="token punctuation">(</span>privkey<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    rsakey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>privkey<span class="token punctuation">)</span>
    signer <span class="token operator">=</span> PKCS1_v1_5<span class="token punctuation">.</span>new<span class="token punctuation">(</span>rsakey<span class="token punctuation">)</span>
    digest <span class="token operator">=</span> SHA256<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token punctuation">)</span>
    digest<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> signer<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>digest<span class="token punctuation">)</span>


<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'private.key'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> key <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'foo.tgz'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

sign <span class="token operator">=</span> signer<span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'foo.tgz.sha256'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sign<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># gernerate public &amp; private key</span>
$ openssl genrsa -out private.key <span class="token number">2048</span>
$ openssl rsa -in private.key -pubout -out public.key

$ python3 sign.py
$ openssl dgst -sha256 -verify public.key -signature foo.tgz.sha256 foo.tgz
Verified OK</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Verify a file from a signed digest</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> sys

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Signature <span class="token keyword">import</span> PKCS1_v1_5
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Hash <span class="token keyword">import</span> SHA256

<span class="token keyword">def</span> <span class="token function">verifier</span><span class="token punctuation">(</span>pubkey<span class="token punctuation">,</span> sig<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    rsakey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    signer <span class="token operator">=</span> PKCS1_v1_5<span class="token punctuation">.</span>new<span class="token punctuation">(</span>rsakey<span class="token punctuation">)</span>
    digest <span class="token operator">=</span> SHA256<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token punctuation">)</span>

    digest<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> signer<span class="token punctuation">.</span>verify<span class="token punctuation">(</span>digest<span class="token punctuation">,</span> sig<span class="token punctuation">)</span>


<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"public.key"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> key <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"foo.tgz.sha256"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> sig <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"foo.tgz"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> verifier<span class="token punctuation">(</span>key<span class="token punctuation">,</span> sig<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Verified OK"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Verification Failure"</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># gernerate public &amp; private key</span>
$ openssl genrsa -out private.key <span class="token number">2048</span>
$ openssl rsa -in private.key -pubout -out public.key

<span class="token comment"># do verification</span>
$ <span class="token function">cat</span> /dev/urandom <span class="token operator">|</span> <span class="token function">head</span> -c <span class="token number">512</span> <span class="token operator">|</span> base64 <span class="token operator">></span> foo.txt
$ <span class="token function">tar</span> -zcf foo.tgz foo.txt
$ openssl dgst -sha256 -sign private.key -out foo.tgz.sha256 foo.tgz
$ python3 verify.py
Verified OK

<span class="token comment"># do verification via openssl</span>
$ openssl dgst -sha256 -verify public.key -signature foo.tgz.sha256 foo.tgz
Verified OK</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Simple RSA encrypt via pem file</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_v1_5

key_text <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># import key via rsa module</span>
pubkey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key_text<span class="token punctuation">)</span>

<span class="token comment"># create a cipher via PKCS1.5</span>
cipher <span class="token operator">=</span> PKCS1_v1_5<span class="token punctuation">.</span>new<span class="token punctuation">(</span>pubkey<span class="token punctuation">)</span>

<span class="token comment"># encrypt</span>
cipher_text <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b"Hello RSA!"</span><span class="token punctuation">)</span>

<span class="token comment"># do base64 encode</span>
cipher_text <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>cipher_text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipher_text<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ openssl genrsa -out private.key <span class="token number">2048</span>
$ openssl rsa -in private.key -pubout -out public.key
$ <span class="token function">cat</span> public.key                                <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 rsa.py                                <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -d -A                          <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl rsautl -decrypt -inkey private.key
Hello RSA<span class="token operator">!</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Simple RSA encrypt via RSA module</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_v1_5
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey<span class="token punctuation">.</span>RSA <span class="token keyword">import</span> construct

<span class="token comment"># prepare public key</span>
e <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'10001'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
pubkey <span class="token operator">=</span> construct<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># create a cipher via PKCS1.5</span>
cipher <span class="token operator">=</span> PKCS1_v1_5<span class="token punctuation">.</span>new<span class="token punctuation">(</span>pubkey<span class="token punctuation">)</span>

<span class="token comment"># encrypt</span>
cipher_text <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b"Hello RSA!"</span><span class="token punctuation">)</span>

<span class="token comment"># do base64 encode</span>
cipher_text <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>cipher_text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipher_text<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ openssl genrsa -out private.key <span class="token number">2048</span>
$ openssl rsa -in private.key -pubout -out public.key
$ <span class="token comment"># check (n, e)</span>
$ openssl rsa -pubin -inform PEM -text -noout <span class="token operator">&lt;</span> public.key
Public-Key: <span class="token punctuation">(</span><span class="token number">2048</span> bit<span class="token punctuation">)</span>
Modulus:
    00:93:d5:58:0c:18:cf:91:f0:74:af:1b:40:09:73:
    0c:d8:13:23:6c:44:60:0d:83:71:e6:f9:61:85:e5:
    b2:d0:8a:73:5c:02:02:51:9a:4f:a7:ab:05:d5:74:
    ff:4d:88:3d:e2:91:b8:b0:9f:7e:a9:a3:b2:3c:99:
    1c:9a:42:4d:ac:2f:6a:e7:eb:0f:a7:e0:a5:81:e5:
    <span class="token number">98</span>:49:49:d5:15:3d:53:42:12:08:db:b0:e7:66:2d:
    <span class="token number">71</span>:5b:ea:55:4e:2d:9b:40:79:f8:7d:6e:5d:f4:a7:
    d8:13:cb:13:91:c9:ac:5b:55:62:70:44:25:50:ca:
    <span class="token number">94</span>:de:78:5d:97:e8:a9:33:66:4f:90:10:00:62:21:
    b6:60:52:65:76:bd:a3:3b:cf:2a:db:3f:66:5f:0d:
    a3:35:ff:29:34:26:6d:63:a2:a6:77:96:5a:84:c7:
    6a:0c:4f:48:52:70:11:8f:85:11:a0:78:f8:60:4b:
    5d:d8:4b:b2:64:e5:ec:99:72:c5:a8:1b:ab:5c:09:
    e1:80:70:91:06:22:ba:97:33:56:0b:65:d8:f3:35:
    <span class="token number">66</span>:f8:f9:ea:b9:84:64:8e:3c:14:f7:3d:1f:2c:67:
    ce:64:cf:f9:c5:16:6b:03:a1:7a:c7:fa:4c:38:56:
    ee:e0:4d:5f:ec:46:7e:1f:08:7c:e6:45:a1:fc:17:
    1f:91
Exponent: <span class="token number">65537</span> <span class="token punctuation">(</span>0x10001<span class="token punctuation">)</span>
$ openssl rsa -pubin -in public.key -modulus -noout <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> <span class="token function">cut</span> -d<span class="token string">'='</span> -f <span class="token number">2</span>                                    <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 rsa.py                                    <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -d -A                              <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl rsautl -decrypt -inkey private.key
Hello RSA<span class="token operator">!</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Simple RSA decrypt via pem file</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_v1_5

<span class="token comment"># read key file</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'private.key'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> key_text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># create a private key object</span>
privkey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key_text<span class="token punctuation">)</span>

<span class="token comment"># create a cipher object</span>
cipher <span class="token operator">=</span> PKCS1_v1_5<span class="token punctuation">.</span>new<span class="token punctuation">(</span>privkey<span class="token punctuation">)</span>

<span class="token comment"># decode base64</span>
cipher_text <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># decrypt</span>
plain_text <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher_text<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>plain_text<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ openssl genrsa -out private.key <span class="token number">2048</span>
$ openssl rsa -in private.key -pubout -out public.key
$ <span class="token builtin class-name">echo</span> <span class="token string">"Hello openssl RSA encrypt"</span>                 <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl rsautl -encrypt -pubin -inkey public.key <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -e -A                             <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 rsa.py
Hello openssl RSA encrypt</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Simple RSA encrypt with OAEP</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_OAEP

<span class="token comment"># read key file</span>
key_text <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># create a public key object</span>
pubkey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key_text<span class="token punctuation">)</span>

<span class="token comment"># create a cipher object</span>
cipher <span class="token operator">=</span> PKCS1_OAEP<span class="token punctuation">.</span>new<span class="token punctuation">(</span>pubkey<span class="token punctuation">)</span>

<span class="token comment"># encrypt plain text</span>
cipher_text <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b"Hello RSA OAEP!"</span><span class="token punctuation">)</span>

<span class="token comment"># encode via base64</span>
cipher_text <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>cipher_text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipher_text<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ openssl genrsa -out private.key <span class="token number">2048</span>
$ openssl rsa -in private.key -pubout -out public.key
$ <span class="token function">cat</span> public.key         <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 rsa.py         <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -d -A   <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl rsautl -decrypt -oaep -inkey private.key
Hello RSA OAEP<span class="token operator">!</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Simple RSA decrypt with OAEP</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_OAEP

<span class="token comment"># read key file</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'private.key'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> key_text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># create a private key object</span>
privkey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key_text<span class="token punctuation">)</span>

<span class="token comment"># create a cipher object</span>
cipher <span class="token operator">=</span> PKCS1_OAEP<span class="token punctuation">.</span>new<span class="token punctuation">(</span>privkey<span class="token punctuation">)</span>

<span class="token comment"># decode base64</span>
cipher_text <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># decrypt</span>
plain_text <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher_text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>plain_text<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ openssl genrsa -out private.key <span class="token number">2048</span>
$ openssl rsa -in private.key -pubout -out public.key
$ <span class="token builtin class-name">echo</span> <span class="token string">"Hello RSA encrypt via OAEP"</span>                      <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl rsautl -encrypt -pubin -oaep -inkey public.key <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -e -A                                   <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 rsa.py
Hello RSA encrypt via OAEP</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Using DSA to proof of identity</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">import</span> socket

<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> InvalidSignature
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> hashes
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> dsa

alice<span class="token punctuation">,</span> bob <span class="token operator">=</span> socket<span class="token punctuation">.</span>socketpair<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">gen_dsa_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    private_key <span class="token operator">=</span> dsa<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span>
        key_size<span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">,</span> backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> private_key<span class="token punctuation">,</span> private_key<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">sign_data</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> private_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    signature <span class="token operator">=</span> private_key<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>data<span class="token punctuation">,</span> hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> signature


<span class="token keyword">def</span> <span class="token function">verify_data</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> public_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        public_key<span class="token punctuation">.</span>verify<span class="token punctuation">(</span>signature<span class="token punctuation">,</span> data<span class="token punctuation">,</span> hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> InvalidSignature<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"recv msg: {} not trust!"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"check msg: {} success!"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># generate alice private &amp; public key</span>
alice_private_key<span class="token punctuation">,</span> alice_public_key <span class="token operator">=</span> gen_dsa_key<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># alice send message to bob, then bob recv</span>
alice_msg <span class="token operator">=</span> <span class="token string">b"Hello Bob"</span>
b <span class="token operator">=</span> alice<span class="token punctuation">.</span>send<span class="token punctuation">(</span>alice_msg<span class="token punctuation">)</span>
bob_recv_msg <span class="token operator">=</span> bob<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>

<span class="token comment"># alice send signature to bob, then bob recv</span>
signature <span class="token operator">=</span> sign_data<span class="token punctuation">(</span>alice_msg<span class="token punctuation">,</span> alice_private_key<span class="token punctuation">)</span>
b <span class="token operator">=</span> alice<span class="token punctuation">.</span>send<span class="token punctuation">(</span>signature<span class="token punctuation">)</span>
bob_recv_signature <span class="token operator">=</span> bob<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>

<span class="token comment"># bob check message recv from alice</span>
verify_data<span class="token punctuation">(</span>bob_recv_msg<span class="token punctuation">,</span> bob_recv_signature<span class="token punctuation">,</span> alice_public_key<span class="token punctuation">)</span>

<span class="token comment"># attacker modify the msg will make the msg check fail</span>
verify_data<span class="token punctuation">(</span><span class="token string">b"I'm attacker!"</span><span class="token punctuation">,</span> bob_recv_signature<span class="token punctuation">,</span> alice_public_key<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ python3 test_dsa.py
check msg: b<span class="token string">'Hello Bob'</span> success<span class="token operator">!</span>
recv msg: b<span class="token string">"I'm attacker!"</span> not trust<span class="token operator">!</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<h2>Using AES CBC mode encrypt a file</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> struct
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> <span class="token punctuation">(</span>
    Cipher<span class="token punctuation">,</span>
    algorithms<span class="token punctuation">,</span>
    modes<span class="token punctuation">)</span>

backend <span class="token operator">=</span> default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
iv  <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>ptext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pad <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">.</span>padder<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ptext <span class="token operator">=</span> pad<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ptext<span class="token punctuation">)</span> <span class="token operator">+</span> pad<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>

    alg <span class="token operator">=</span> algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    mode <span class="token operator">=</span> modes<span class="token punctuation">.</span>CBC<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span>alg<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> backend<span class="token operator">=</span>backend<span class="token punctuation">)</span>
    encryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ctext <span class="token operator">=</span> encryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ptext<span class="token punctuation">)</span> <span class="token operator">+</span> encryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> ctext

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"key: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"iv: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"usage: cmd [file] [enc file]"</span><span class="token punctuation">)</span>

<span class="token comment"># read plain text from file</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    plaintext <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># encrypt file</span>
ciphertext <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">"Encrypt file via AES-CBC"</span> <span class="token operator">></span> test.txt
$ python3 aes.py test.txt test.enc
key: f239d9609e3f318b7afda7e4bb8db5b8734f504cf67f55e45dfe75f90d24fefc
iv: 8d6383b469f100d25293fb244ccb951e
$ openssl aes-256-cbc -d -in test.enc -out secrets.txt.new            <span class="token punctuation">\</span>
<span class="token operator">></span> -K f239d9609e3f318b7afda7e4bb8db5b8734f504cf67f55e45dfe75f90d24fefc <span class="token punctuation">\</span>
<span class="token operator">></span> -iv 8d6383b469f100d25293fb244ccb951e
$ <span class="token function">cat</span> secrets.txt.new
Encrypt <span class="token function">file</span> via AES-CBC</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Using AES CBC mode decrypt a file</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> struct
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">from</span> binascii <span class="token keyword">import</span> unhexlify

<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> <span class="token punctuation">(</span>
    Cipher<span class="token punctuation">,</span>
    algorithms<span class="token punctuation">,</span>
    modes<span class="token punctuation">)</span>

backend <span class="token operator">=</span> default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> ctext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alg <span class="token operator">=</span> algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    mode <span class="token operator">=</span> modes<span class="token punctuation">.</span>CBC<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span>alg<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> backend<span class="token operator">=</span>backend<span class="token punctuation">)</span>
    decryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ptext <span class="token operator">=</span> decryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ctext<span class="token punctuation">)</span> <span class="token operator">+</span> decryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>

    unpadder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unpadder<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 128 bit</span>
    ptext <span class="token operator">=</span> unpadder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ptext<span class="token punctuation">)</span> <span class="token operator">+</span> unpadder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> ptext

<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"usage: cmd [key] [iv] [file]"</span><span class="token punctuation">)</span>

<span class="token comment"># read cipher text from file</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    ciphertext <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># decrypt file</span>
key<span class="token punctuation">,</span> iv <span class="token operator">=</span> unhexlify<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> unhexlify<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plaintext <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>key<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> ciphertext<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">"Encrypt file via AES-CBC"</span> <span class="token operator">></span> test.txt
$ <span class="token assign-left variable">key</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>openssl rand -hex <span class="token number">32</span><span class="token variable">`</span></span>
$ <span class="token assign-left variable">iv</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>openssl rand -hex <span class="token number">16</span><span class="token variable">`</span></span>
$ openssl enc -aes-256-cbc -in test.txt -out test.enc -K <span class="token variable">$key</span> -iv <span class="token variable">$iv</span>
$ python3 aes.py <span class="token variable">$key</span> <span class="token variable">$iv</span> test.enc</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>AES CBC mode encrypt via password (using cryptography)</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> struct
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5<span class="token punctuation">,</span> sha1

<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> <span class="token punctuation">(</span>
    Cipher<span class="token punctuation">,</span>
    algorithms<span class="token punctuation">,</span>
    modes<span class="token punctuation">)</span>

backend <span class="token operator">=</span> default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">EVP_ByteToKey</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> key_len<span class="token punctuation">,</span> iv_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
    buf <span class="token operator">=</span> md<span class="token punctuation">(</span>pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> buf
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>iv_len <span class="token operator">+</span> key_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> md<span class="token punctuation">(</span>d <span class="token operator">+</span> pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
        buf <span class="token operator">+=</span> d
    <span class="token keyword">return</span> buf<span class="token punctuation">[</span><span class="token punctuation">:</span>key_len<span class="token punctuation">]</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>key_len<span class="token punctuation">:</span>key_len <span class="token operator">+</span> iv_len<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">aes_encrypt</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> ptext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">:</span>
    key_len<span class="token punctuation">,</span> iv_len <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">16</span>

    <span class="token comment"># generate salt</span>
    salt <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>

    <span class="token comment"># generate key, iv from password</span>
    key<span class="token punctuation">,</span> iv <span class="token operator">=</span> EVP_ByteToKey<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> key_len<span class="token punctuation">,</span> iv_len<span class="token punctuation">)</span>

    <span class="token comment"># pad plaintext</span>
    pad <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">.</span>padder<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ptext <span class="token operator">=</span> pad<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ptext<span class="token punctuation">)</span> <span class="token operator">+</span> pad<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># create an encryptor</span>
    alg <span class="token operator">=</span> algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    mode <span class="token operator">=</span> modes<span class="token punctuation">.</span>CBC<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span>alg<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> backend<span class="token operator">=</span>backend<span class="token punctuation">)</span>
    encryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># encrypt plain text</span>
    ctext <span class="token operator">=</span> encryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ptext<span class="token punctuation">)</span> <span class="token operator">+</span> encryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ctext <span class="token operator">=</span> <span class="token string">b'Salted__'</span> <span class="token operator">+</span> salt <span class="token operator">+</span> ctext

    <span class="token comment"># encode base64</span>
    ctext <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>ctext<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ctext


<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"usage: CMD [md]"</span><span class="token punctuation">)</span>

md <span class="token operator">=</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

plaintext <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
pwd <span class="token operator">=</span> <span class="token string">b"password"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>aes_encrypt<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> plaintext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># with md5 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Encrypt plaintext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py md5                                         <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -d -A                                       <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -md md5 -d -k password
Encrypt plaintext via AES-CBC from a given password

<span class="token comment"># with sha1 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Encrypt plaintext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py sha1                                        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -d -A                                       <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -md sha1 -d -k password
Encrypt plaintext via AES-CBC from a given password</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>AES CBC mode decrypt via password (using cryptography)</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> struct
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5<span class="token punctuation">,</span> sha1

<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> padding
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>ciphers <span class="token keyword">import</span> <span class="token punctuation">(</span>
    Cipher<span class="token punctuation">,</span>
    algorithms<span class="token punctuation">,</span>
    modes<span class="token punctuation">)</span>

backend <span class="token operator">=</span> default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">EVP_ByteToKey</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> key_len<span class="token punctuation">,</span> iv_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
    buf <span class="token operator">=</span> md<span class="token punctuation">(</span>pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> buf
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>iv_len <span class="token operator">+</span> key_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> md<span class="token punctuation">(</span>d <span class="token operator">+</span> pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
        buf <span class="token operator">+=</span> d
    <span class="token keyword">return</span> buf<span class="token punctuation">[</span><span class="token punctuation">:</span>key_len<span class="token punctuation">]</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>key_len<span class="token punctuation">:</span>key_len <span class="token operator">+</span> iv_len<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">aes_decrypt</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> ctext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ctext <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>ctext<span class="token punctuation">)</span>

    <span class="token comment"># check magic</span>
    <span class="token keyword">if</span> ctext<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">b'Salted__'</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"bad magic number"</span><span class="token punctuation">)</span>

    <span class="token comment"># get salt</span>
    salt <span class="token operator">=</span> ctext<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>

    <span class="token comment"># generate key, iv from password</span>
    key<span class="token punctuation">,</span> iv <span class="token operator">=</span> EVP_ByteToKey<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>

    <span class="token comment"># decrypt</span>
    alg <span class="token operator">=</span> algorithms<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    mode <span class="token operator">=</span> modes<span class="token punctuation">.</span>CBC<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> Cipher<span class="token punctuation">(</span>alg<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> backend<span class="token operator">=</span>backend<span class="token punctuation">)</span>
    decryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decryptor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ptext <span class="token operator">=</span> decryptor<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ctext<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> decryptor<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># unpad plaintext</span>
    unpadder <span class="token operator">=</span> padding<span class="token punctuation">.</span>PKCS7<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unpadder<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 128 bit</span>
    ptext <span class="token operator">=</span> unpadder<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ptext<span class="token punctuation">)</span> <span class="token operator">+</span> unpadder<span class="token punctuation">.</span>finalize<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ptext<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"usage: CMD [md]"</span><span class="token punctuation">)</span>

md <span class="token operator">=</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

ciphertext <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
pwd <span class="token operator">=</span> <span class="token string">b"password"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>aes_decrypt<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># with md5 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Decrypt ciphertext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -e -md md5 -salt -A -k password         <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -e -A                                        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py md5
Decrypt ciphertext via AES-CBC from a given password

<span class="token comment"># with sha1 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Decrypt ciphertext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -e -md sha1 -salt -A -k password        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -e -A                                        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py sha1
Decrypt ciphertext via AES-CBC from a given password</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>AES CBC mode encrypt via password (using pycrypto)</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> struct
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5<span class="token punctuation">,</span> sha1
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random<span class="token punctuation">.</span>random <span class="token keyword">import</span> getrandbits

<span class="token comment"># AES CBC requires blocks to be aligned on 16-byte boundaries.</span>
BS <span class="token operator">=</span> <span class="token number">16</span>

pad <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span> s <span class="token operator">+</span> <span class="token punctuation">(</span>BS <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">%</span> BS<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>BS <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">%</span> BS<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
unpad <span class="token operator">=</span> <span class="token keyword">lambda</span> s <span class="token punctuation">:</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">EVP_ByteToKey</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> key_len<span class="token punctuation">,</span> iv_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
    buf <span class="token operator">=</span> md<span class="token punctuation">(</span>pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> buf
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>iv_len <span class="token operator">+</span> key_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> md<span class="token punctuation">(</span>d <span class="token operator">+</span> pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
        buf <span class="token operator">+=</span> d
    <span class="token keyword">return</span> buf<span class="token punctuation">[</span><span class="token punctuation">:</span>key_len<span class="token punctuation">]</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>key_len<span class="token punctuation">:</span>key_len <span class="token operator">+</span> iv_len<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">aes_encrypt</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> plaintext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">:</span>
    key_len<span class="token punctuation">,</span> iv_len <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">16</span>

    <span class="token comment"># generate salt</span>
    salt <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">'=Q'</span><span class="token punctuation">,</span> getrandbits<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># generate key, iv from password</span>
    key<span class="token punctuation">,</span> iv <span class="token operator">=</span> EVP_ByteToKey<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> key_len<span class="token punctuation">,</span> iv_len<span class="token punctuation">)</span>

    <span class="token comment"># pad plaintext</span>
    plaintext <span class="token operator">=</span> pad<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>

    <span class="token comment"># create a cipher object</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>

    <span class="token comment"># ref: openssl/apps/enc.c</span>
    ciphertext <span class="token operator">=</span> <span class="token string">b'Salted__'</span> <span class="token operator">+</span> salt <span class="token operator">+</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>

    <span class="token comment"># encode base64</span>
    ciphertext <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ciphertext

<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"usage: CMD [md]"</span><span class="token punctuation">)</span>

md <span class="token operator">=</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

plaintext <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
pwd <span class="token operator">=</span> <span class="token string">b"password"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>aes_encrypt<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> plaintext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># with md5 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Encrypt plaintext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py md5                                         <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -d -A                                       <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -md md5 -d -k password
Encrypt plaintext via AES-CBC from a given password

<span class="token comment"># with sha1 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Encrypt plaintext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py sha1                                        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -d -A                                       <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -md sha1 -d -k password
Encrypt plaintext via AES-CBC from a given password</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>AES CBC mode decrypt via password (using pycrytpo)</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token punctuation">,</span> unicode_literals

<span class="token keyword">import</span> struct
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5<span class="token punctuation">,</span> sha1
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random<span class="token punctuation">.</span>random <span class="token keyword">import</span> getrandbits

<span class="token comment"># AES CBC requires blocks to be aligned on 16-byte boundaries.</span>
BS <span class="token operator">=</span> <span class="token number">16</span>

unpad <span class="token operator">=</span> <span class="token keyword">lambda</span> s <span class="token punctuation">:</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span>s<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">EVP_ByteToKey</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> key_len<span class="token punctuation">,</span> iv_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
    buf <span class="token operator">=</span> md<span class="token punctuation">(</span>pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> buf
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>iv_len <span class="token operator">+</span> key_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> md<span class="token punctuation">(</span>d <span class="token operator">+</span> pwd <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
        buf <span class="token operator">+=</span> d
    <span class="token keyword">return</span> buf<span class="token punctuation">[</span><span class="token punctuation">:</span>key_len<span class="token punctuation">]</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>key_len<span class="token punctuation">:</span>key_len <span class="token operator">+</span> iv_len<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">aes_decrypt</span><span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ciphertext <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span>

    <span class="token comment"># check magic</span>
    <span class="token keyword">if</span> ciphertext<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">b'Salted__'</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"bad magic number"</span><span class="token punctuation">)</span>

    <span class="token comment"># get salt</span>
    salt <span class="token operator">=</span> ciphertext<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>

    <span class="token comment"># get key, iv</span>
    key<span class="token punctuation">,</span> iv <span class="token operator">=</span> EVP_ByteToKey<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> md<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>

    <span class="token comment"># decrypt</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
    <span class="token keyword">return</span> unpad<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>ciphertext<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"usage: CMD [md]"</span><span class="token punctuation">)</span>

md <span class="token operator">=</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

ciphertext <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
pwd <span class="token operator">=</span> <span class="token string">b"password"</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>aes_decrypt<span class="token punctuation">(</span>pwd<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> md<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>output:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># with md5 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Decrypt ciphertext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -e -md md5 -salt -A -k password         <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -e -A                                        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py md5
Decrypt ciphertext via AES-CBC from a given password

<span class="token comment"># with sha1 digest</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"Decrypt ciphertext via AES-CBC from a given password"</span> <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl aes-256-cbc -e -md sha1 -salt -A -k password        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> openssl base64 -e -A                                        <span class="token operator">|</span><span class="token punctuation">\</span>
<span class="token operator">></span> python3 aes.py sha1
Decrypt ciphertext via AES-CBC from a given password</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Ephemeral Diffie Hellman Key Exchange via cryptography</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> dh
<span class="token operator">>></span><span class="token operator">></span> params <span class="token operator">=</span> dh<span class="token punctuation">.</span>generate_parameters<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> a_key <span class="token operator">=</span> params<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># alice's private key</span>
<span class="token operator">>></span><span class="token operator">></span> b_key <span class="token operator">=</span> params<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># bob's private key</span>
<span class="token operator">>></span><span class="token operator">></span> a_pub_key <span class="token operator">=</span> a_key<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> b_pub_key <span class="token operator">=</span> b_key<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> a_shared_key <span class="token operator">=</span> a_key<span class="token punctuation">.</span>exchange<span class="token punctuation">(</span>b_pub_key<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> b_shared_key <span class="token operator">=</span> b_key<span class="token punctuation">.</span>exchange<span class="token punctuation">(</span>a_pub_key<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> a_shared_key <span class="token operator">==</span> b_shared_key
<span class="token boolean">True</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Calculate DH shared key manually via cryptography</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> dh
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>utils <span class="token keyword">import</span> int_from_bytes
<span class="token operator">>></span><span class="token operator">></span> a_key <span class="token operator">=</span> params<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># alice's private key</span>
<span class="token operator">>></span><span class="token operator">></span> b_key <span class="token operator">=</span> params<span class="token punctuation">.</span>generate_private_key<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># bob's private key</span>
<span class="token operator">>></span><span class="token operator">></span> a_pub_key <span class="token operator">=</span> a_key<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> b_pub_key <span class="token operator">=</span> b_key<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> shared_key <span class="token operator">=</span> int_from_bytes<span class="token punctuation">(</span>a_key<span class="token punctuation">.</span>exchange<span class="token punctuation">(</span>b_pub_key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> shared_key_manual <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>a_pub_key<span class="token punctuation">.</span>public_numbers<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                         b_key<span class="token punctuation">.</span>private_numbers<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                         params<span class="token punctuation">.</span>parameter_numbers<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>p<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> shared_key <span class="token operator">==</span> shared_key_manual
<span class="token boolean">True</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Calculate DH shared key from (p, g, pubkey)</h2>
<div class="gatsby-highlight" data-language="python"><pre style="counter-reset: linenumber NaN" class="language-python line-numbers"><code class="language-python"><span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> dh
<span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>utils <span class="token keyword">import</span> int_from_bytes

backend <span class="token operator">=</span> default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span>

p <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">"11859949538425015739337467917303613431031019140213666"</span>
        <span class="token string">"12902540730065402658508634532306628480096346320424639"</span>
        <span class="token string">"0256567934582260424238844463330887962689642467123"</span><span class="token punctuation">)</span>

g <span class="token operator">=</span> <span class="token number">2</span>

y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">"32155788395534640648739966373159697798396966919821525"</span>
        <span class="token string">"72238852825117261342483718574508213761865276905503199"</span>
        <span class="token string">"969908098203345481366464874759377454476688391248"</span><span class="token punctuation">)</span>

x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">"409364065449673443397833358558926598469347813468816037"</span>
        <span class="token string">"268451847116982490733450463194921405069999008617231539"</span>
        <span class="token string">"7147035896687401350877308899732826446337707128"</span><span class="token punctuation">)</span>

params <span class="token operator">=</span> dh<span class="token punctuation">.</span>DHParameterNumbers<span class="token punctuation">(</span>p<span class="token punctuation">,</span> g<span class="token punctuation">)</span>
public <span class="token operator">=</span> dh<span class="token punctuation">.</span>DHPublicNumbers<span class="token punctuation">(</span>y<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
private <span class="token operator">=</span> dh<span class="token punctuation">.</span>DHPrivateNumbers<span class="token punctuation">(</span>x<span class="token punctuation">,</span> public<span class="token punctuation">)</span>

key <span class="token operator">=</span> private<span class="token punctuation">.</span>private_key<span class="token punctuation">(</span>backend<span class="token punctuation">)</span>
shared_key <span class="token operator">=</span> key<span class="token punctuation">.</span>exchange<span class="token punctuation">(</span>public<span class="token punctuation">.</span>public_key<span class="token punctuation">(</span>backend<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># check shared key</span>
shared_key <span class="token operator">=</span> int_from_bytes<span class="token punctuation">(</span>shared_key<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
shared_key_manual <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">,</span> p<span class="token punctuation">)</span>   <span class="token comment"># y^x mod p</span>

<span class="token keyword">assert</span> shared_key <span class="token operator">==</span> shared_key_manual</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p><a href="https://www.pythonsheets.com/">Acesse a Referência original 1:</a>
<a href="https://www.pythoncheatsheet.org/">Acesse a Referência original 2:</a></p></section><hr style="margin-bottom:1.75rem"/><footer><div style="display:flex;margin-bottom:4.375rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAACwUlEQVQ4y42UWU8UQRDHefFjGL+Arz6aKIlHMOFNXiSBqFEw0ZiIbtCAIYTIIYeGQ1dwOeKycigQD1DX5QwJEoSNirLdPdPbMz3dM73LqfFNaxjDrhiBpDLpY37dVf+q6gxKyM6mx4i2af9uZeyEIWKa2FlB9jKCr2FgHe8NBtISeH6UhnxWoFB2+0R0knKBYX1HGLuucguHHxt3j6mX98yxIBuq5jAeDzLOU/x2GGIj3wiL4+iUXpWpYlEtsY6cZaTW0OcZvTpTLc5qjBHP/xQMc8DgYIMRiLC/zBqo4M4qwova3FtKNaLWUc8ta6iGS4X1WBoMJFhyA828iFcdSUTaje4b1vuAYUn3rECBbDsvl3+ikWYz5BN2AmkpGJO45k4GK83qoyroE71l1mgn67oqkt8R/kqEg1vPyoE7PFhkjTQbMPXCzvCuNQziz7P9efLTtP4xTOtPKRjUgELdDKKN6/ADrjycqDup4hr27nNhLyVTfaz1nNz4FYNoQef+Mg5SQ7T1WarrioCBWkXPynlfqQXibRWMC4MbIy1mQ7YKB9jzCt5bakFVRNrZu0eGwfDTYqvljC0TaLTT6LwshIP0FIwJo+TLB32wivfctK4dWJnqZYEC0Zxjh9sM2IVU+fPlRIhND7D2QilV2s1e9YKqkz2s8bTzutF802KCvCAVhKNtbkU6WG8Jf3Xf7LvNZeJvGCbgecclWXIwGbgoyw8lF8YpKESWiAdDYYHDTTmOt75V4X/yDKnSlsjsMJ0L09rjCtQCxost+QMBeX3/CpSHsHF6e6WKBPIBANQGpHq4yRQKw4qGSKjYurBvLVgkIAvpXbG9POHUphy7Idvx59sPc+0HuXZdlqo9ocaeMCDhIPrfloTLqcvPR+jCGI1O6NFxHdoAZIOuhrLf5TFwldCIaeAtY3G3sbe9AXt6SXa133dG1a0ljAUNAAAAAElFTkSuQmCC" alt="Reativa" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/d2742f2dddd737dec60ee2a5226edb06/000d3/icon.png 1x,
/static/d2742f2dddd737dec60ee2a5226edb06/bc2a0/icon.png 1.5x,
/static/d2742f2dddd737dec60ee2a5226edb06/89cf4/icon.png 2x" /><img loading="lazy" width="50" height="50" srcset="/static/d2742f2dddd737dec60ee2a5226edb06/000d3/icon.png 1x,
/static/d2742f2dddd737dec60ee2a5226edb06/bc2a0/icon.png 1.5x,
/static/d2742f2dddd737dec60ee2a5226edb06/89cf4/icon.png 2x" src="/static/d2742f2dddd737dec60ee2a5226edb06/000d3/icon.png" alt="Reativa" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p><strong>Está curtindo os conteúdos da Reativa? Quer que a gente te ajude a ser um dev melhor?<!-- --> </strong> <!-- --> <a href="http://bit.ly/form-reativa" target="_blank" rel="noopener noreferrer">Deixe seu melhor email aqui.</a> </p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/python-tests/">← <!-- -->Python tudo sobre Testes</a></li><li><a rel="next" href="/python-new-py3/">Python tudo sobre novidades no Python3<!-- --> →</a></li></ul></nav></main><footer>© <!-- -->2020<!-- -->, Sua melhor escolha para aprender programação:<!-- --> <a href="https://reativa.dev">Reativa Tecnologia</a></footer></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-155080700-5', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/python-security/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-da4c9f678cc075cd8c26.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-2642abeb110b544c12ef.js"],"component---src-pages-404-js":["/component---src-pages-404-js-ba8fab707f547b8d2140.js"],"component---src-pages-index-js":["/component---src-pages-index-js-511e09b2f0f1386b8494.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-2642abeb110b544c12ef.js" async=""></script><script src="/commons-2011af21236d35f89581.js" async=""></script><script src="/app-da4c9f678cc075cd8c26.js" async=""></script><script src="/netlify-identity-widget-71f3202b04975b5e224a.js" async=""></script><script src="/styles-989bb08664f2608f37ec.js" async=""></script><script src="/webpack-runtime-002569f02672c1c38772.js" async=""></script></body></html>